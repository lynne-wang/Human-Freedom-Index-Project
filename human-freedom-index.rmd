---
title: "Human Freedom Index Project"
author: "Team Platypus: Lynne Wang, Neel Gajjar, Kate Neal"
output: pdf_document
---

```{r packages-data, warning=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
require(maps)
require(viridis)
theme_set(
  theme_gray()
  )
hfi <- read_csv("data/hfi_cc_2019.csv") 
```

```{r set-warning-message-echo}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
```
### INTRODUCTION

Freedom is one of the most crucial concepts in the modern world, playing a large role in human progress and the dignity of individuals. Freedom is of great value to humanity as it can protect humans against natural disasters, social problems, and economic issues by expanding the set of human choices and offering constructive democratic relations in society (Jafarzadeh 323). Though freedom itself is a rather abstract term that can be difficult to quantify, it can be broken down into various measures encompassing personal, civic, and economic freedom. We are particularly interested in negative liberty, defined as freedom from interference by other people, or the absence of coercive constraint. Positive liberty, on the other hand, has vastly different meanings for different individuals and is more difficult to measure. Moreover, one individual’s conception of positive liberty can interfere with others’ negative liberty, so it is more worthwhile to measure the latter. 


While freedom has always been an essential topic across the globe, it has been especially relevant in recent years, following an alarming rise in authoritarian regimes across the world and a continual struggle between power and liberty. As the world has become ever more globalized, we are beginning to see stark differences between the quality of life of individuals in countries with varying degrees of overall freedom. It appears that the general trajectory of modernization is not evenly distributed across different countries, and modernization itself does not always go hand in hand with greater freedom. As we continue to face ever-present issues of political tensions and uneven distribution of resources, along with emerging issues such as pandemics and the potential dangers of new technologies, freedom must be carefully observed and negotiated to promote the best possible outcome for societies.


We wish to isolate the relationships between freedom and other social and economic phenomena, as well as understand the ways in which different facets of freedom interact with each other. In particular, we will examine whether economic, and personal liberties can stand alone or must necessarily hinge on each other, and what their relationship is. We are also interested in the difference in overall and particular freedoms over time between Post-Soviet and Western/NATO countries, and how government size may affect freedom. Furthermore, we are interested in which attributes of freedom contribute the most to a country or region’s overall freedom, as well as which regions rank extremely in particular and overall freedom. Moreover, we would like to map the flux in global or regional freedom over the past few years.


From prevailing research, we hypothesize that economic freedom is essential and positively correlated with all other freedoms and that it is a crucial component of overall freedom. We believe that Post-Soviet countries are less free than NATO countries today, and that smaller government is correlated with greater overall and personal freedom. We also believe that higher scores on women-specific freedoms are positively correlated with all other freedoms and that personal freedom is positively correlated with political freedom. In accordance with the increase of authoritarian regimes around the globe, we hypothesize that overall freedom has decreased over the past few years.



### DATA DESCRIPTION

The observations in this dataset follow 162 countries over several years, for a total of 1620 observations (162 countries, 10 years) and 120 variables. Countries were limited to those represented in the Economic Freedoms of the World report (Gwartney et al). Beginning in 2008, which was the first year enough data could be found to create a robust index, through 2017, 79 different indicators of personal and economic freedom were measured for the different countries. These specific indicators were used to give each country a freedom index, on a scale of 0 to 10, where 10 represents more freedom. The abstract term of freedom, in this context, was interpreted to be a “social concept that recognizes the dignity of individuals and is defined by the absence of coercive constraint.” 


The indicators fell into the following categories: rule of law, security and safety, movement, religion, association, assembly, and civil society, expression and information, identity and relationships, size of government, legal system and property rights, access to sound money, freedom to trade internationally, and regulation of credit, labor, and business. To get the final overall freedom index value, the economic freedom subindex (size of government, legal system and property rights, access to sound money, freedom to trade internationally, and regulation of credit, labor, and business) receives half the weight, while safety and security and other personal freedoms receive the remaining weight. Within each subindex, indicators (37 from the personal freedom subindex and 42 from the economic freedom subindex) within each category were weighted equally (averaged) to get a score between 0 and 10 for each indicator. Categories were weighted equally in the economic freedom subindex and rule of law and safety and security were weighted half of the personal freedom subindex, while the other categories equally made up the other half. 


The data contributing to the numerical values for each of the indicators came from the following criteria: credible external sources, not generated by researchers doing the index analysis, transparent on methodology and sources, and covering as large a number of countries over as long a time period as possible. The 0-10 numerical values in each indicator already existed from other indices, such as the Global Peace Index, the Rule of Law Index, or the Economic Freedoms of the World Index (Gwartney et al). For countries not included in any given index, values were determined by regressing said index’s measures with other measures that data was obtainable for within that indicator. For example, countries not in the Rule of Law Index were regressed with rule of law measures from the World Bank’s Worldwide Governance Indicators. 

### GLIMPSE OF DATA

```{r glimpse}
glimpse(hfi)
```


### METHODOLOGY

### Overall Human Freedom

### Visualizations

To visualize the change in human freedom over the years, we plotted the year, as a factor, against our calculation of the mean human freedom score per year on a line graph. To visualize the average human freedom score for each country over the years, we calculated a mean human freedom score for each country and plotted the scores over a world map. 

```{r overall, warning=FALSE, message=FALSE}
hfscore_by_year <- hfi %>% 
  filter(hf_score != "-") %>% 
  group_by(year) %>% 
  summarize(mean_hf = mean(as.numeric(hf_score)))

ggplot(data = hfscore_by_year, 
       aes(x = as.factor(year), y = mean_hf, group = 1)) +
  geom_line(stat = "identity") +
  ylim(6.75, 7.25) + 
  labs(x = "Year", y = "Human Freedom Score", 
       title = "Graph 1: Overall Human Freedom on the Decline",
       subtitle = "2008 to 2017")
```

```{r freedom-map}
summarized_hfi <- hfi %>% 
  filter(hf_score != "-") %>% 
  group_by(countries) %>% 
  mutate(mean_hf = mean(as.numeric(hf_score))) %>% 
  slice(1) %>% 
  mutate(countries = ifelse(countries == "United States", "USA", countries)) %>% 
  summarize(countries, mean_hf)

world_map <- map_data("world")
freedom_map <- left_join(world_map, summarized_hfi, by = c("region" = "countries"))

# Create the map
ggplot(freedom_map, mapping = aes(long, lat, group = group)) +
  coord_fixed(1.3) +
  geom_polygon(aes(fill = as.numeric(mean_hf)), color = "white") +
  scale_fill_distiller(palette ="RdBu", direction = 1) +
  labs(title = "Graph 2: Average Freedom Around the World")
```

As seen in graph 1, overall freedom has been on a decline from 2008 to 2017 (dropping from an average of ~7.1 to ~6.9), in accordance with our initial hypothesis. Graph 2 shows us that developed countries, particularly those in North America, Western Europe, and Oceania had higher overall freedom scores across the board (> 7), shown in dark blue. Meanwhile, developing countries in Africa had significantly lower overall freedom scores across the board (< 6), shown in dark red. Countries in South America, Eastern Europe, and Asia fell somewhere near the middle (6-7), shown in light blue or light red. 

### Relationship Between Economic Freedom and Personal Freedom

Initial visualization of difference between economic and personal freedom
We did some exploratory data analysis to examine the difference in economic freedom and personal freedom scores across different countries. We calculated the mean economic freedom score and mean personal freedom score across the years for each country, and took their difference. We plotted these differences on a histogram.

```{r economic-and-personal-freedom}
no_na_hfi <- hfi %>% 
  filter(pf_score != "-" & ef_score != "-")

clean_hfi <- no_na_hfi %>% 
  group_by(countries) %>% 
  mutate(mean_pf = mean(as.numeric(pf_score)),
         mean_ef = mean(as.numeric(ef_score))) %>% 
  mutate(diff_ef_pf = mean_ef - mean_pf) %>% 
  slice(1) %>% 
  summarize(countries, mean_ef, mean_pf, diff_ef_pf)

mean_diff <- clean_hfi %>% 
  summarize(mean_diff = mean(diff_ef_pf))

ggplot(data = clean_hfi, aes(x = diff_ef_pf)) +
  geom_histogram(bins = 30) +
  geom_vline(linetype = "dashed", xintercept = c(mean_diff$mean_diff)) +
  labs(x = "Difference in Economic and Personal Freedom Score", 
       y = "Count", 
       title = "Graph 3: Mean Difference in Economic and Personal Freedom Score < 0",
       subtitle = "Average Diffs from 2008 to 2017, 162 Countries")
```

As seen in graph 3, the mean difference in economic freedom score and personal freedom score appears to be less than 0, which differs from our initial belief that an increase in economic freedom would always indicate an increase in personal freedom.

### Bootstrap simulation based testing

Next, we assessed whether the difference in economic freedom score and personal freedom score was statistically significant using a bootstrap simulation test. We performed 500 bootstrap simulations on a variable we created to describe the mean difference in economic and personal freedom score over the years for a particular country. We conducted our test at the $\alpha$ = 0.05 significance level, which tests the two hypotheses below:

$H_0$: the difference between mean economic freedom score and mean personal freedom score is greater than or equal to zero.

$H_A$: the difference between mean economic freedom score and mean personal freedom score is less than zero.

```{r bootstrap-ef-pf-95-conf}
set.seed(10)
n_sims <- 500
boot_dist = numeric(n_sims) 
for(i in 1:n_sims){ 
  indices <- sample(1:nrow(clean_hfi), replace = T)
  boot_mean <- clean_hfi %>% 
    slice(indices) %>%                    
    summarize(boot_mean = mean(diff_ef_pf)) %>% 
    pull()                                
  boot_dist[i] <- boot_mean 
}

boot_means = tibble(boot_dist)
mu_0 <- 0
offset <- boot_means %>% 
  summarize(mu_0 - mean(boot_dist)) %>%
  pull()
boot_means <- boot_means %>%
  mutate(shifted_means = boot_dist + offset)
boot_1 <- boot_means%>%
  summarize(lower = quantile(shifted_means, 0.025), 
            upper = quantile(shifted_means, 0.975))
boot_1
```

```{r bootstrap-ef-pf-obs-diff}
obs_mean <- clean_hfi %>% 
  summarize(mean(diff_ef_pf)) %>% 
  pull()
obs_mean
```

```{r bootstrap-ef-pfp-val}
obs_diff <- mu_0 - obs_mean
boot_means %>% 
  mutate(extreme = ifelse(shifted_means <= mu_0 - obs_diff |
                          shifted_means >= mu_0 + obs_diff, 1, 0)) %>% 
  summarize(p_val = mean(extreme))
```

```{r bootstrap-ef-pf-visualization, warning=FALSE, message=FALSE}
ggplot(data = boot_means, aes(x = shifted_means)) +
  geom_histogram(color = "darkblue", fill = "skyblue") + 
  labs(x = "Difference in Economic and Personal Freedom Score", y = "Count", 
       title = "Sufficient Evidence to Suggest Difference Between 
       Economic and Personal Freedom Scores is Less than Zero",
       subtitle = "500 bootstrap reps with Observed Prop and 95% CI shown") +
  geom_vline(xintercept = c(boot_1$lower, boot_1$upper),
             color = "red") +
  geom_vline(linetype = "dashed", xintercept = c(mean_diff$mean_diff))
```

### Visualization of economic and personal freedom difference by region

Given the significant p-value of our bootstrap test statistic, and our visualization of average human freedom score on a world map, we visualized the difference in economic and personal freedom score by region. We calculated the difference for each region, sorted the differences from lowest to highest, and graphed them on a bar chart. 

```{r region-economic-personal-diff, warning=FALSE, message=FALSE}
region_hfi <- no_na_hfi %>% 
  group_by(region) %>% 
  mutate(mean_pf = mean(as.numeric(pf_score)),
         mean_ef = mean(as.numeric(ef_score))) %>% 
  mutate(diff_ef_pf = mean_ef - mean_pf,
         score = ifelse(diff_ef_pf > 0, 
                        "ef_score > pf_score", "ef_score < pf_score")) %>% 
  slice(1) %>% 
  summarize(region, mean_ef, mean_pf, diff_ef_pf, score)

ggplot(data = region_hfi, aes(x = reorder(region, diff_ef_pf), 
                              y = diff_ef_pf, fill = score)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 30)) +
  labs(x = "Region", y = "Diff in EF and PF Scores", 
       title = "Graph 4: Personal Freedom Lagging Behind 
       Economic Freedom in Developing Countries",
       subtitle = "Data from 162 countries from 2008-2017")
```

As seen in graph 4, it appears that economic freedom is slightly higher than personal freedom in developing countries, particularly in the Middle East & North Africa. Meanwhile, personal freedom scores appear to be significantly higher than economic freedom scores in developed countries, particularly in Western Europe (and in Western countries overall).

### Pearson correlation coefficient and visualization of relationship between economic and personal freedom

While it seemed that economic freedom was generally lower than personal freedom in developed countries, and generally higher than personal freedom in developing countries, we were curious whether there was a correlation between economic and personal freedom scores. We calculated the Pearson correlation coefficient between ef_score and pf_score and graphed ef_score against pf_score for all of our observations in a scatterplot.

```{r corr-ef-pf}
corr_efpf <- no_na_hfi %>% 
  summarize(cor_ef_pf = cor(as.numeric(ef_score), as.numeric(pf_score)))
corr_efpf
```

```{r corr-ef-pf-scatterplot, warning=FALSE, message=FALSE}
ggplot(data = no_na_hfi, aes(x = as.numeric(ef_score), 
                             y = as.numeric(pf_score))) +
  geom_point(alpha = 0.5, position = "jitter") + 
  geom_smooth(method="lm") +
  labs(x = "Economic Freedom Score", y = "Personal Freedom Score", 
       title = "Graph 5: Positive Correlation Between Economic and Personal Freedom",
       subtitle = "Data from 162 countries from 2008-2017")
```

It appears that there is a moderate to strong positive correlation between economic freedom score and personal freedom score. It also appears that there is a greater upper bound to personal freedom score compared to economic freedom score.

### Relationship Between Cold War Status and Freedom

### Visualizations

We decided to examine the difference in overall freedom between Post-Soviet and NATO countries, as well as their difference in mean government size. To visualize the difference in mean government size over the years between Post-Soviet and NATO countries, we first selected the main countries that were involved in the Cold War, and divided them into Post-Soviet and NATO countries. Our Post-Soviet group included Russia, Ukraine, Moldova, Uzbekistan, Kazakhstan, Kyrgyzstan, Tajikistan, Turkmenistan, Georgia, Azerbaijan, Armenia, Lithuania, Latvia, and Estonia. Our NATO/Western group included Belgium, Canada, Denmark, France, Germany, Greece, Iceland, Italy, Luxembourg, The Netherlands, Norway, Portugal, Spain, Turkey, The United Kingdom, and The United States. We first calculated the mean government size (using the ef_government variable, where a higher score indicates a smaller government and decreased government control) for each group per year and graphed this over a line graph. We then calculated the mean human freedom score for each group per year and graphed this over a line graph.

```{r coldwar, warning=FALSE, message=FALSE}
hfi_coldwar <- hfi %>% 
  mutate(post_soviet = ifelse(countries == "Russia" | 
                                countries == "Ukraine" | 
                                countries == "Moldova" | 
                                countries == "Uzbekistan" | 
                                countries == "Kazakhstan" | 
                                countries == "Kyrgyzstan" | 
                                countries == "Tajikistan" | 
                                countries == "Turkmenistan" | 
                                countries == "Georgia" | 
                                countries == "Azerbaijan" | 
                                countries == "Armenia" | 
                                countries == "Lithuania" | 
                                countries == "Latvia" | 
                                countries == "Estonia", "yes", "no")) %>% 
  mutate(nato = ifelse(countries == "Belgium" | 
                         countries == "Canada" | 
                         countries == "Denmark" | 
                         countries == "France" | 
                         countries == "Germany" | 
                         countries == "Greece" | 
                         countries == "Iceland" | 
                         countries == "Italy" | 
                         countries == "Luxembourg" | 
                         countries == "Netherlands" | 
                         countries == "Norway" | 
                         countries == "Portugal" | 
                         countries == "Spain" | 
                         countries == "Turkey" | 
                         countries == "United Kingdom" | 
                         countries == "United States", "yes", "no")) %>% 
  filter(post_soviet == "yes" | nato == "yes") %>% 
  mutate(coldwar_side = ifelse(post_soviet == "yes", "soviet", "western"))
  

ef_govt_coldwar <- hfi_coldwar %>% 
  filter(ef_government != "-") %>% 
  select(countries, coldwar_side, year, ef_government) %>% 
  group_by(year, coldwar_side) %>% 
  mutate(mean_ef_government = mean(as.numeric(ef_government)))

ggplot(data = ef_govt_coldwar, 
       aes(x = as.factor(year), y = mean_ef_government, group = coldwar_side, color = coldwar_side)) +
  geom_line(stat = "identity") +
  labs(x = "Year", y = "Smaller Government", 
       title = "Graph 6: Post-Soviet Countries Have Smaller Governments 
       Than Western Countries",
       subtitle = "2008 to 2017, Higher Score = Smaller Government") +
  theme(axis.line.y = element_line(arrow = arrow()))

hf_coldwar <- hfi_coldwar %>% 
  filter(hf_score != "-") %>% 
  select(countries, coldwar_side, year, hf_score) %>% 
  group_by(year, coldwar_side) %>% 
  mutate(mean_hf = mean(as.numeric(hf_score)))

ggplot(data = hf_coldwar, 
       aes(x = as.factor(year), y = mean_hf, group = coldwar_side, color = coldwar_side)) +
  geom_line(stat = "identity") +
  labs(x = "Year", y = "Human Freedom Score", 
       title = "Graph 7: Post-Soviet Countries Less Free Than Western Countries",
       subtitle = "2008 to 2017")
```

As seen in graphs 6 and 7, it appears that former Soviet countries’ governments have been decreasing in size, while Western countries’ governments have been increasing in size. Moreover, Post-Soviet countries appear to have smaller governments on average compared to Western countries, with about a difference of 1 point in ef_government. It appears that smaller government does not necessarily lead to greater overall human freedom, which differs from our initial hypothesis.

### Linear regression of Cold War status and government size, in relation to overall freedom

In order to parse out a clearer relationship between Cold War status and government size, and overall freedom score, we performed a linear regression of Cold War side, government size (ef_government), and their interaction, on overall freedom score. 

### Linear regression of Cold War status and government size, in relation to personal freedom

In order to parse out a clearer relationship between Cold War status and government size, and personal freedom score, we performed a linear regression of Cold War side, government size (ef_government), and their interaction, on personal freedom score. 


### RESULTS

### Relationship Between Economic Freedom and Personal Freedom

### Bootstrap simulation based testing

Our p-value is 0, and so we reject the null hypothesis at the $\alpha$ = 0.05 significance level. There is sufficient evidence to suggest that the difference between mean economic freedom score and mean personal freedom score is less than zero. In other words, on average, economic freedom scores tend to be lower than personal freedom scores around the world.

### Relationship Between Cold War Status and Freedom

Linear regression of Cold War status and government size, in relation to overall freedom
Our fitted linear regression model on the relationship between Cold War status and government size, and overall human freedom, is as follows:

Human Freedom Score = 4.26 + 4.58(If Western) + 0.44(ef_government) - 0.55(ef_government * If Western)

Human Freedom Score for Western Countries: 8.84 - 0.11(ef_government)

Human Freedom Score for Post-Soviet Countries: 4.26 + 0.44(ef_government) 

For the average country on the Western side in the Cold War, their average human freedom score in the past decade has been 8.84 at an ef_government score of 0 (large government), and all else held constant, it is 0.11 points lower for every additional point in the ef_government score (smaller government).

For the average country on the Soviet side in the Cold War, their average human freedom score in the past decade has been 4.26 at an ef_government score of 0 (large government), and all else held constant, it is 0.44 points higher for every additional point in the ef_government score (smaller government).

$H_0$: $\beta_0$ = 0

$H_A$: $\beta_1$ $\neq$ 0

Our results are statistically significant, and the relationship between government size and overall human freedom does depend on a country’s Cold War status. Our test statistic is -6.67. The p-value (1.48e-10) is less than 0.05 at the alpha = 0.05 significance level, so we reject the null hypothesis. The data provide strong evidence that the true slope parameter is different from 0, and there is sufficient evidence to suggest that there is a difference in the relationship between government size and overall human freedom depending on a country’s Cold War status.

In our particular case, it appears that the effect of government size on human freedom score depends on whether the country was on the Western or Soviet side during the Cold War. Countries that were on the Soviet side experience a higher overall human freedom score when they have smaller governments, while countries that were on the Western side experience a lower overall human freedom score when they have smaller governments.

In terms of the effectiveness of our model, we obtain R^2 = 0.49. In the context of the problem, 0.49 of the variability in the response variable (overall human freedom) is explained by the model.

### Linear regression of Cold War status and government size, in relation to personal freedom

Our fitted linear regression model on the relationship between Cold War status and government size, and personal freedom, is as follows:

Personal Freedom Score = 4.49 + 5.99(If Western) + 0.44(ef_government) - 0.72(ef_government * If Western)

Personal Freedom Score for Western Countries: 10.48 - 0.28(ef_government)

Personal Freedom Score for Post-Soviet Countries: 4.49 + 0.44(ef_government) 

For the average country on the Western side in the Cold War, their average personal freedom score in the past decade has been 10.48 at an ef_government score of 0 (large government), and all else held constant, it is 0.28 points lower for every additional point in the ef_government score (smaller government).

For the average country on the Soviet side in the Cold War, their average personal freedom score in the past decade has been 4.49 at an ef_government score of 0 (large government), and all else held constant, it is 0.44 points higher for every additional point in the ef_government score (smaller government).

$H_0$: $\beta_0$ = 0

$H_A$: $\beta_1$ $\neq$ 0

Our results are statistically significant, and the relationship between government size and personal freedom does depend on a country’s Cold War status. Our test statistic is -6.41. The p-value (6.53e-10) is less than 0.05 at the alpha = 0.05 significance level, so we reject the null hypothesis. The data provide strong evidence that the true slope parameter is different from 0, and there is sufficient evidence to suggest that there is a difference in the relationship between government size and personal freedom depending on a country’s Cold War status.

In our particular case, it appears that the effect of government size on personal freedom score depends on whether the country was on the Western or Soviet side during the Cold War. Countries that were on the Soviet side experience a higher overall personal freedom score when they have smaller governments, while countries that were on the Western side experience a lower overall personal freedom score when they have smaller governments.

In terms of the effectiveness of our model, we obtain R^2 = 0.51. In the context of the problem, 0.51 of the variability in the response variable (personal freedom) is explained by the model.



### Women-Specific Freedoms

In order to remove the effects of women-specific freedom scores from a country’s overall human freedom index, we created new variables for each main freedom subcategory, as well as overall human freedom that did not include women-specific freedoms. We also created a variable that represented overall women-specific freedom score, with the same weight given to each category as in the overall freedom index. Any correlation found between women-specific freedom score and overall freedom score should not be influenced by women’s freedom categories that contribute to the overall. 

```{r unweighting-wsf, warning=FALSE, message=FALSE}
hfi <- hfi%>%
  mutate(pf_movement_nowomen = (as.numeric(pf_movement_domestic) 
                                + as.numeric(pf_movement_foreign))/2)
hfi <- hfi%>%
  mutate(pf_ss_nowomen = (as.numeric(pf_ss_homicide) 
                          + as.numeric(pf_ss_disappearances))/2)
hfi <- hfi%>%
  mutate(pf_identity_nowomen = (as.numeric(pf_identity_legal) 
                          + as.numeric(pf_identity_sex_male))/2)

hfi <- hfi%>%
  mutate(pf_rol = as.numeric(pf_rol))%>%
  mutate(pf_religion = as.numeric(pf_religion))%>%
  mutate(pf_association = as.numeric (pf_association))%>%
  mutate(pf_expression = as.numeric(pf_expression))%>%
  mutate(ef_score = as.numeric(ef_score))%>%
  mutate(hfi_women_unweighted = (ef_score * 0.5) 
         + (pf_rol * 0.125)
         + (pf_ss_nowomen * 0.125)
         + (pf_movement_nowomen * 0.05)
         + (pf_identity_nowomen * 0.05)
         + (pf_expression * 0.05)
         + (pf_association * 0.05)
         + (pf_religion * 0.05))
hfi <- hfi%>%
  mutate(pf_score_nowomen = (pf_rol * 0.25)
         + (pf_ss_nowomen * 0.25)
         + (pf_movement_nowomen * 0.1)
         + (pf_identity_nowomen * 0.1)
         + (pf_expression * 0.1)
         + (pf_association * 0.1)
         + (pf_religion * 0.1))

ws_only <- hfi%>%
  select(pf_ss_women, pf_ss_women_fgm, pf_ss_women_inheritance, 
         pf_ss_women_inheritance_daughters, pf_ss_women_inheritance_widows,
         pf_movement_women, pf_identity_sex_female, pf_identity_divorce, 
         hfi_women_unweighted, ef_score, pf_score_nowomen, pf_religion, region)
ws_only <- ws_only%>%
  mutate(pf_ss_women = as.numeric(pf_ss_women))%>%
  mutate(pf_movement_women = as.numeric(pf_movement_women))%>%
  mutate(pf_identity_divorce = as.numeric(pf_identity_divorce))%>%
  mutate(pf_identity_sex_female = as.numeric(pf_identity_sex_female))%>%

  mutate(ws_score = (((pf_identity_divorce + pf_identity_sex_female)/2) + pf_ss_women + pf_movement_women)/3)
```

### Correlating Women-Specific Freedom to Overall Freedom

Now that the contribution of women-specific (W-S) freedoms should have no effect on the correlation with overall freedom, we did some initial visualization of countries' W-S score with their overall human freedom score. There appeared to be an overall linear positive correlation, with a few outliers that had high W-S freedom scores, but relatively low overall freedom scores. 

```{r ws-hfi-scatter, warning=FALSE, message=FALSE}
ws_no_na <- ws_only%>%
    filter(!is.na(hfi_women_unweighted) & !is.na(ws_score)) 

ggplot(data = ws_no_na, aes(x = ws_score, 
                             y = hfi_women_unweighted)) +
  geom_point(alpha = 0.5, position = "jitter") + 
  geom_smooth(method="lm") +
  labs(x = "Women-Specific Freedoms Score", y = "Overall Freedom Score", 
       title = "Graph 8: Positive Correlation Between Women-Specific and Overall 
       Freedom",
       subtitle = "Data from 162 countries from 2008-2017")
```

After seeing that there was a general positive trend, we calculated the correlation coefficient of W-S score and the unweighted human freedom index.
```{r correlation-women-vs-overall, warning=FALSE, message=FALSE}
corr_ws_hf <- ws_no_na%>%
  summarize(cor_ws_hfi = cor(ws_score, hfi_women_unweighted))
corr_ws_hf
```
A correlation coefficient of 0.505 told us that there is a moderate, linear, positive correlation between the two variables. This means that countries with higher overall freedom scores are more likely to also have higher women-specific freedom scores, though the two are correlational, not causal. 
 
### W-S freedom to personal vs economic freedom 
Through our bootstrapping earlier (see graph 3 and subsequent simulation based testing), we saw that the mean difference between economic and personal freedom was less 0. We wanted to explore the correlations between women-specific freedom and economic freedom, and women-specific freedom and (women-unweighted) personal freedoms, specifically on the difference between the two. Our initial hypothesis was that women-specific freedom would not have the same correlation with economic freedom and personal freedom, since indicators in the personal freedom category were more directly linked to allowing behaviour or specific freedoms to be lived out while economic freedom is more related to the acquisition and exchange of property and capital by individuals. 

We first did initial visualizations and calculated the correlation of women-specific freedoms, with economic and personal freedom, respectively, removing observations with null values. 

```{r ws-ef-scatter-and-corr, warning=FALSE, message=FALSE}
ws_no_na <- ws_no_na%>%
  filter(!is.na(ef_score) & !is.na(pf_score_nowomen))
ggplot(data = ws_no_na, aes(x = ws_score, 
                             y = ef_score)) +
  geom_point(alpha = 0.5, position = "jitter") + 
  geom_smooth(method="lm") +
  labs(x = "Women-Specific Freedoms Score", y = "Economic Freedom Score", 
       title = "Graph 9a: Positive Correlation Between Women-Specific and 
       Economic Freedom",
       subtitle = "Correlation less strong than overall HFI")

corr_ws_ef <- ws_no_na%>%
  summarize(cor_ws_hfi = cor(ws_score, ef_score))
corr_ws_ef
```
Women-specific and economic freedom had an observed correlation coefficient of 0.32. This weak-to-moderate positive linear correlation is less strong than the correlation between women-specific freedom and overall freedom, but still means that countries with higher economic freedom typically also have higher W-S freedom. There are a few outliers, like before, that had high W-S freedom but low economic freedom. 

```{r ws-pf-scatter-and-corr, warning=FALSE, message=FALSE}
ggplot(data = ws_no_na, aes(x = ws_score, 
                             y = pf_score_nowomen)) +
  geom_point(alpha = 0.5, position = "jitter") + 
  geom_smooth(method="lm") +
  labs(x = "Women-Specific Freedoms Score", y = "Personal Freedom Score", 
       title = "Graph 9b: Positive Correlation Between Women-Specific and 
       Personal Freedom")

corr_ws_pf <- ws_no_na%>%
  summarize(cor_ws_hfi = cor(ws_score, pf_score_nowomen))
corr_ws_pf
```
Women-specific and personal freedom had an observed correlation coefficient of 0.56. This moderate positive linear correlation was quite similar to the correlation between women-specific freedom and overall freedom, indicating that countries with higher personal freedom typically also have higher W-S freedom. There are no obvious outliers, but a fairly large range of economic freedom scores that correspond to high women-specific freedom score, indicating that countries could have high or low economic freedom, but still have high women-specific freedom. 

```{r ws-ef-pf-obs-diff-in-corr}
obs_diff_corr <- ws_no_na%>%
  summarize(obs_diff_corr = (cor(ws_score, pf_score_nowomen) - cor(ws_score, ef_score)))
obs_diff_corr
```
We calculated the observed difference between correlation coefficients of the above two visualizations (women-specific vs economic freedom and women-specific vs personal freedom) to be 0.24. On a scale of -1 to 1, this was a large enough difference that we wanted to test if we could truly say the correlations were different. 

### Bootstrap simulation difference in correlations

We performed 2000 bootstrap simulations on a variable we created to describe the difference in correlations between women-specific (w-s) freedom to economic and personal freedom score. We conducted our test at the $\alpha$ = 0.01 significance level, which tests the two hypotheses below:


Null hypothesis: There is no difference in the average correlation between w-s freedom to personal freedom and w-s freedom to economic freedom
Alt hypothesis: There is a difference in the average correlation between w-s freedom to personal freedom and w-s freedom to economic freedom
Significance level: $\alpha$ = 0.01
```{r ws-personal-economic-hyptohesis}
set.seed(10)
n_sims <- 2000
boot_distribution = numeric(n_sims) 
for(i in 1:n_sims){ 
  indices <- sample(1:nrow(ws_no_na), replace = T)
  boot_cor <- ws_no_na %>% 
    slice(indices) %>%                    
    summarize(boot_cor = (cor(ws_score, pf_score_nowomen) - cor(ws_score, ef_score))) %>% 
    pull()                                
  boot_distribution[i] <- boot_cor 
}

boot_cors = tibble(boot_distribution)

mu_0 <- 0
offset <- boot_cors %>% 
  summarize(mu_0 - mean(boot_distribution)) %>%
  pull()

boot_cors <- boot_cors %>%
  mutate(shifted_cors = boot_distribution + offset)

boot_2 <- boot_cors%>%
  summarize(lower = quantile(shifted_cors, 0.005), 
            upper = quantile(shifted_cors, 0.995))
boot_2
```
Our initial 99% confidence interval for the hypothesis is -0.12 to 0.12, which does not include the observed value. This means that if we were to reconduct this study over and over, we would expect 99% of those intervals to contain the true difference in correlation, IF the null hypothesis were true. Since our observed value is outside that range, it begins to lead us to conclude to reject the null hypothesis, but we will visualized the distribution and caluated the p-value to make sure. 

```{r bootstrap-ws-ef-pf-visualization-and-pval}
ggplot(data = boot_cors, aes(x = shifted_cors)) +
  geom_histogram(color = "darkblue", fill = "skyblue") + 
  labs(x = "Voice Jitter", 
       title = 
       "Bootstrap Distribution of Difference in Correlations Centered at 0 
       appears Normal", 
       subtitle = "Observed value outside of 99% confidence interval") +
  geom_vline(xintercept = c(boot_2$lower, boot_2$upper),
             color = "red") +
  geom_vline(linetype = "dashed", xintercept = c(obs_diff_corr$obs_diff_corr))


boot_cors %>% 
  mutate(extreme2 = ifelse(shifted_cors <= mu_0 - obs_diff_corr |
                          shifted_cors >= mu_0 + obs_diff_corr, 1, 0)) %>% 
  summarize(p_val2 = mean(extreme2))

```
The distribution appears normal, and our observed statistic is well outside of the confidence interval. 

Our p value is 0, which is less than our significance level of $\alpha$ = 0.01. This means we rejected the null hypothesis, and found sufficient evidence to suggest that the difference in correlations between W-S freedom to personal freedom and W-S freedom to economic freedom was not zero. 

### Women-Specific Freedoms and Religious Freedom 

Heavy control by governing bodies on religion and women are often related, anecdotally, so we explored this a bit. First we visualized the average personal freedom category of religion for each region. The regions are colored by their mean women-specific freedom score.


```{r ws-religion-visualization, message=FALSE}
region_ws <- ws_no_na %>% 
  group_by(region) %>% 
  mutate(mean_pf_religion = mean(as.numeric(pf_religion)))%>% 
  mutate(mean_ws = mean(as.numeric(ws_score)))%>% 
  slice(1) %>% 
  summarize(region, mean_pf_religion, mean_ws)

mid <- ws_no_na%>%
  summarize(mid = mean(ws_score))

ggplot(data = region_ws, aes(x = reorder(region, mean_pf_religion), 
                              y = mean_pf_religion, fill = mean_ws)) +
  scale_fill_gradient(low = "red", high = "blue", na.value = NA) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 20)) +
  labs(x = "Region", y = "Average Religion Freedom Score", 
       title = "Graph 10: General increase in mean W-S score with higher
       religious freedom score",
       subtitle = "Sub-Saharan Africa does not fit trend",
       fill = "Mean W-S freedom score")
```
There appears to be a general trend that regions with higher religious freedom score have higher women-specific freedom score, and vice versa. Middle East and North Africa, which has the lowest religious freedom score, also has the lowest W-S freedom score. Sub-Saharan africa does not fit with this pattern as clearly, with its moderate religious freedom score but a W-S score on the lower end. 


### Chi-Squared Test for Independence

In order to determine if above average women-specific freedom score and above average religious freedom score are associated, we performed a Chi-Squared test at the $\alpha$ = 0.05 significance level. Our null hypothesis is that there is no relationship between whether a country's women-specific freedom score is above or below average and whether their religious freedom score is above or below average. Our alternative hypothesis is that there is a relationship between the two, and the variables are not independent. We calculated the average freedom scores for each category and created a new variable for each that listed if the observation was above or below average for each criteria. 

```{r ws-religion-chisq}
mean_ws <- ws_no_na%>%
  summarize(mean_ws = mean(ws_score))

mean_rel <- hfi%>%
  filter(pf_religion != "-")%>%
  summarize(mean_rel = mean(pf_religion))

ws_no_na<-ws_no_na%>%
  mutate(religion_avg = ifelse(pf_religion >= 7.834794, 
                        "Above Average", "Below Average"))
ws_no_na<-ws_no_na%>%
  mutate(ws_average = ifelse(ws_score >= 8.942593, 
                        "Above Average", "Below Average"))

chisq.test(table(ws_no_na$religion_avg, ws_no_na$ws_average))
```
Our test statistic was 13.408. If the null hypothesis were true, then the test statistic should have a chi-squared distribution with 1 degree of freedom. The p-value of seeing our observed chi-squared statistic or even larger was 0.0002505. This is less than our $\alpha$ = 0.05 significance level, so we reject the null hypothesis. There is enough evidence for us to suggest that these two variables are not independent, meaning that there is a relationship between a country's women's freedom score being above or below average, and its religious freedom score being above or below average. 

### Results Summary
Mean overall freedom has declined from 2008-2018, globally.

Economic freedom is slightly higher than personal freedom in developingcountries, particularly in the Middle East & North Africa. Meanwhile, personal freedom scores appear to besignificantly higher than economic freedom scores in developed countries, particularly in Western Europe(and in Western countries overall).

There is a moderate to strong positive correlation between economic freedom score and personalfreedom score.

Economic freedom scores tend to be lower than personal freedom scores around the world.

There is a difference in the relationship between government size and overall human freedom depending on acountry’s Cold War status. Previously Soviet countries’ governments have been decreasing in size. Western countries’ governments have been increasing in size. Post-Soviet countries have smaller governments on average compared to Western countries. Smaller government does not necessarily lead to greater overall human freedom. 

There is a moderate, linear, positive correlation between women-specific freedoms and overall human freedom.

Women-specific and economic freedom had a weak-to-moderate, positive, linear correlation. Women-specific and personal freedom had an observed correlation coefficient of 0.56. This moderate positive linear correlation. 

There is a difference in the correlation between women-specific freedom to personal freedom and women-specific freedom to economic freedom

There is a general trend that regions with higher religious freedom score have higher women-specificfreedom score, and vice versa.

There isa relationship between a country’s women’s freedom score being above or below average, and its religiousfreedom score being above or below average.

### Discussion

